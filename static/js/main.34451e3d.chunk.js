(this.webpackJsonplm=this.webpackJsonplm||[]).push([[0],{26:function(t,e,a){},38:function(t,e,a){},39:function(t,e,a){},42:function(t,e,a){},43:function(t,e,a){},44:function(t,e,a){},45:function(t,e,a){},53:function(t,e,a){"use strict";a.r(e);var n=a(2),i=a(3),r=a(5),s=a(4),c=a(1),o=a.n(c),u=a(28),l=a.n(u),h=a(31),d=a(6),j=(a(38),a(26),a(39),a(13)),f=a(12),p=a(11),b=a(33),O=a(25),g=a(29),m=a(22),v=a.n(m),x=a(18),y=a(30),k={imageCache:{}};function C(t){var e=new XMLHttpRequest;return e.open("get",t),e.send(null),console.log("call loadFile"),new Promise((function(a,n){e.onload=function(){4===e.readyState&&(200===e.status?a(e.responseText):n("Load file "+t+" failed."))}}))}function I(t){var e=new Image;return e.src=t+"?t="+Math.random(),e.crossOrigin="",new Promise((function(t,a){e.onload=function(a){t(e)}}))}function w(t){return S.apply(this,arguments)}function S(){return(S=Object(y.a)(v.a.mark((function t(e){var a,n,i,r,s,c,o,u,l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object.keys(e).map((function(t){return{imageObj:null,index:e[t].pic.index,path:e[t].pic.path,id:e[t].pic.picId}})),n=Object(x.a)(a),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=15;break}if(r=i.value,!k.imageCache[r.id]){t.next=10;break}r.imageObj=k.imageCache[r.id],t.next=13;break;case 10:return t.next=12,I(r.path);case 12:r.imageObj=t.sent;case 13:t.next=4;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),n.e(t.t0);case 20:return t.prev=20,n.f(),t.finish(20);case 23:(s=document.createElement("canvas")).width=a[0].imageObj.width,s.height=a[0].imageObj.height,(c=s.getContext("2d")).fillStyle="#ffffff",null===c||void 0===c||c.fillRect(0,0,s.width,s.height),a.sort((function(t,e){return t.index-e.index})),o=Object(x.a)(a);try{for(o.s();!(u=o.n()).done;)(l=u.value).imageObj&&(null===c||void 0===c||c.drawImage(l.imageObj,0,0))}catch(h){o.e(h)}finally{o.f()}return t.abrupt("return",s);case 33:case"end":return t.stop()}}),t,null,[[2,17,20,23]])})))).apply(this,arguments)}function D(){var t=navigator.userAgent.toLowerCase();return!!(/micromessenger/g.test(t)||/weibo/g.test(t)||/qq/g.test(t))}var N=a(0),F=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){return Object(n.a)(this,a),e.call(this,t)}return Object(i.a)(a,[{key:"createBlob",value:function(){return new Blob([this.props.fileContent],{type:"text/plain;charset=utf-8"})}},{key:"save",value:function(){Object(g.saveAs)(this.createBlob(),this.props.filename)}},{key:"render",value:function(){var t=this;return Object(N.jsx)("a",{href:"#",onClick:function(){return t.save()},className:this.props.className,children:this.props.children})}}]),a}(o.a.Component),B=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).state={imageBase64String:""},i}return Object(i.a)(a,[{key:"transFileToBase64",value:function(t){var e=this;if(t){var a=new FileReader;a.readAsDataURL(t),a.onload=function(t){var a;(null===(a=t.target)||void 0===a?void 0:a.result)!==e.state.imageBase64String&&e.setState({imageBase64String:t.target.result})}}}},{key:"render",value:function(){return this.transFileToBase64(this.props.imageFile),console.log("showimage repeat exec test"),Object(N.jsx)("img",{src:this.state.imageBase64String,alt:""})}}]),a}(o.a.Component),P=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).selectDirInput=void 0,i.selectDirInput=o.a.createRef(),i.state={files:null},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.initSelectDirInput(this.selectDirInput.current)}},{key:"initSelectDirInput",value:function(t){t&&(t.setAttribute("webkitdirectory",""),t.setAttribute("directory",""),t.setAttribute("multiple",""))}},{key:"onGetFiles",value:function(t){this.setState({files:t.target.files}),this.props.handleOutput(t.target.files)}},{key:"render",value:function(){return Object(N.jsx)("div",{children:Object(N.jsx)("input",{type:"file",name:"file",ref:this.selectDirInput,onChange:this.onGetFiles.bind(this)})})}}]),a}(o.a.Component),A=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).canvasObj=void 0,i.canvasObj=o.a.createRef(),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.props.imageObjs.forEach((function(e){try{t.draw(e)}catch(a){console.log(a.message)}}))}},{key:"draw",value:function(t){var e,a=t.width,n=t.height,i=Object(O.a)(this.props.canvasSize,2),r=i[0],s=i[1],c=this.props.border;this.canvasObj.current.width=r,this.canvasObj.current.height=s;var o=this.canvasObj.current.getContext("2d");null===o||void 0===o||o.drawImage(t,0,0,r,s);var u,l=function(t){for(var e=t.data,a=t.width,n=t.height,i=function(t,e){return(t-1)*a*4+4*(e-1)},r=-1,s=-1,c=-1,o=-1,u=1;u<=n;u++){for(var l=1;l<a;l++)if(0!==e[i(u,l)+3]){s=u-1;break}if(-1!==s)break}for(var h=1;h<=a;h++){for(var d=1;d<=n;d++)if(0!==e[i(d,h)+3]){r=h-1;break}if(-1!==r)break}for(var j=n;j>=1;j--){for(var f=1;f<=a;f++)if(0!==e[i(j,f)+3]){o=j-s;break}if(-1!==o)break}for(var p=a;p>=1;p--){for(var b=1;b<=n;b++)if(0!==e[i(b,p)+3]){c=p-r;break}if(-1!==c)break}return[r,s,c,o]}(o.getImageData(0,0,r,s)),h=Object(O.a)(l,4),d=h[0],j=h[1],f=h[2],p=h[3];null===o||void 0===o||o.clearRect(0,0,r,s),u=f>p?[c,(s-(r-2*c)/f*p)/2,r-2*c,(r-2*c)/f*p]:[(r-(s-2*c)/p*f)/2,c,(s-2*c)/p*f,s-2*c],(e=o).drawImage.apply(e,[t,d/r*a,j/s*n,f/r*a,p/s*n].concat(Object(b.a)(u)))}},{key:"render",value:function(){return Object(N.jsx)("canvas",{ref:this.canvasObj})}}]),a}(o.a.Component),M=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){return Object(n.a)(this,a),e.call(this,t)}return Object(i.a)(a,[{key:"onCloseBtnClick",value:function(){this.setState({isOpen:!1})}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var t={position:"absolute",width:"100%",top:0,left:0,zIndex:200,visibility:null===this.props.content?"hidden":"visible"};return Object(N.jsx)("div",{style:{position:"relative"},children:Object(N.jsx)("div",{className:"popup",style:t,children:this.props.content?Object(N.jsx)("img",{style:{width:"100%"},src:this.props.content,alt:""}):Object(N.jsx)("div",{})})})}}]),a}(o.a.Component),L="mini",R="pics",J=a(19);function T(t){return J.Md5.hashStr(t)}function z(t){for(var e={},a=[],n=0,i=Array.from(t);n<i.length;n++){var r=i[n],s=r.webkitRelativePath,c=r.name,o=s.split("/");if(o[1]===R){var u=o.slice(1,3).join("/")+"/"+o[o.length-1],l=T(u);e[l]||(a.push(l),e[l]={}),o[3]===L?e[l].miniPath=o.slice(1).join("/"):(e[l].path=u,e[l].id=l,e[l].filename=c)}}return{hash:U(a),data:e}}function U(t){return T(t.sort((function(t,e){return t>e?1:-1})).join(""))}function E(t){var e,a={},n=function(t){return/default\..*\.png/g.test(t)},i=function(t){return t.replace("default.","").replace(".png","")};for(var r in t){var s=t[r],c=s.path.split("/")[1];if(a[c]||(a[c]={info:{title:c,icon:"",defaultPic:""},items:{}}),e=s.filename,/icon\.png/g.test(e))a[c].info.icon=s.path;else{n(s.filename)&&(a[c].info.defaultPic=r);var o=i(s.filename);a[c].items[o]={title:o,pic:{picId:r,defaultPosition:[0,0]}}}}return a}function W(t,e){var a=Array.from(e),n=E(z(e).data),i=function(t){var e,n=Object(x.a)(a);try{for(n.s();!(e=n.n()).done;){var i=e.value.webkitRelativePath.split("/");if(i[1].split(".")[0]===t)return i.join("/")}}catch(r){n.e(r)}finally{n.f()}return""};return{root:"/sources/"+a[0].webkitRelativePath.split("/")[0]+"/",info:{author:t.info.author,interface:{headImg:i("headImg"),footerImg:i("footerImg"),backgroundImg:i("backgroundImg"),footerText:t.info.interface.footerText,previewHeight:100,previewWidth:100},cover:i("cover"),title:t.info.title},category:function(t,e){var a={};return Object.keys(e).forEach((function(n){var i=e[n],r=t[n];a[n]={info:{title:n,icon:i.info.icon,defaultPic:i.info.defaultPic,allowBlank:r.allowBlank,hide:r.hide,index:r.index},items:Object.keys(i.items).map((function(t){return i.items[t]}))}})),a}(t.category,n)}}function X(t,e,a){var n={};return Object.keys(e).forEach((function(i){var r=e[i];if(r.info.defaultPic){var s=r.info.defaultPic;n[i]=_(t,e,a,i,s)}})),n}function _(t,e,a,n,i){var r=t,s=e[n],c=a,o=s.items.find((function(t){return t.pic.picId===i})),u=c[i];return{itemId:s.items.findIndex((function(t){return t.pic.picId===i})),itemTitle:o.title,pic:{picId:i,path:r+u.path,miniPath:r+(u.miniPath||u.path),position:o.pic.defaultPosition,size:[100,100],index:s.info.index}}}var q=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){return Object(n.a)(this,a),e.call(this,t)}return Object(i.a)(a,[{key:"render",value:function(){var t=this,e=Object.keys(this.props.userData).map((function(e){var a=t.props.userData[e],n=a.pic;return Object(N.jsx)("div",{style:{position:"absolute",top:0,left:0,zIndex:a.pic.index},children:Object(N.jsx)("img",{width:"100%",height:"100%",src:n.miniPath||n.path,alt:a.itemTitle})},a.pic.picId)}));return Object(N.jsx)("div",{className:"preview",style:{position:"relative",width:this.props.width,paddingTop:"100%"},children:e})}}]),a}(o.a.Component),G=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).imageObj=void 0,i.imageObj=function(t,e){if(k.imageCache[t])return k.imageCache[t];var a=new Image;return a.crossOrigin="",a.src=e+"?t="+Math.random(),k.imageCache[t]=a,a}(t.picId,t.path),i.state={canvas:Object(N.jsx)("div",{})},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.imageObj.complete?this.updateCanvas():this.imageObj.onload=function(){t.updateCanvas()}}},{key:"updateCanvas",value:function(){this.setState({canvas:Object(N.jsx)(A,{imageObjs:[this.imageObj],canvasSize:[this.props.size,this.props.size],border:5})})}},{key:"render",value:function(){return Object(N.jsx)("div",{style:{width:this.props.size+"px",height:this.props.size+"px"},children:this.state.canvas})}}]),a}(o.a.Component),H=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).state={},i}return Object(i.a)(a,[{key:"onItemClicked",value:function(t,e){this.props.handleOutput(t,e)}},{key:"render",value:function(){var t=this,e=this.props.itemSize,a=k.root,n=k.config.category[this.props.selectedCategory],i=k.metadata.data,r=n.items.slice();n.info.allowBlank&&r.unshift({title:"",pic:{picId:"",defaultPosition:[0,0]}});var s=r.map((function(n){if(!n.pic.picId)return Object(N.jsx)("div",{onClick:function(){return t.onItemClicked(n.title,n.pic.picId)},className:(t.props.selectedItem===n.title?"selected-item":"")+" item",style:{width:e+"px",height:e+"px"}},"");var r=i[n.pic.picId],s=a+(r.miniPath||r.path);return Object(N.jsx)("div",{onClick:function(){return t.onItemClicked(n.title,n.pic.picId)},className:(t.props.selectedItem===n.title?"selected-item":"")+" item",children:Object(N.jsx)(G,{size:e,path:s,picId:n.pic.picId})},s)}));return Object(N.jsx)("div",{className:"items",children:s})}}]),a}(o.a.Component),Q=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).categoryData=void 0,i.categoryData=k.config.category,i.state={selectedCategory:i.getInitSelectedCategory(),userData:X(k.root,i.categoryData,k.metadata.data),outputImage:null},i.getSelectedItem=i.getSelectedItem.bind(Object(p.a)(i)),i}return Object(i.a)(a,[{key:"getInitSelectedCategory",value:function(){return Object.keys(k.config.category).find((function(t){return 1===k.config.category[t].info.index}))}},{key:"handleCategoryClick",value:function(t){this.setState({selectedCategory:t})}},{key:"getSelectedItem",value:function(t,e){console.log(t);var a=this.state.selectedCategory;if(""===t)return delete this.state.userData[a],void this.setState({userData:Object(f.a)({},this.state.userData)});this.state.userData[a]&&this.state.userData[a].itemTitle===t||this.setState({userData:Object(f.a)(Object(f.a)({},this.state.userData),{},Object(j.a)({},a,_(k.root,this.categoryData,k.metadata.data,a,e)))})}},{key:"downloadOutputImage",value:function(){var t=this,e=w(this.state.userData);D()?e.then((function(e){e.toBlob((function(e){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){var a;t.setState({outputImage:null===(a=e.target)||void 0===a?void 0:a.result})}}))})):e.then((function(t){t.toBlob((function(t){saveAs(t,"output.png")}))}))}},{key:"componentDidUpdate",value:function(t,e){null!=e.outputImage&&this.setState({outputImage:null})}},{key:"render",value:function(){var t=this,e=this.props.width,a=this.categoryData,n=Object.keys(a).sort((function(t,e){return a[t].info.index-a[e].info.index})).map((function(n){var i=a[n].info;return i.hide?Object(N.jsx)("div",{},n):Object(N.jsxs)("div",{className:(t.state.selectedCategory===n?"selected-category":"")+" category-item",style:{width:e/4+"px",height:e/4/1.8+"px"},children:[i.icon&&Object(N.jsx)("img",{src:i.icon,alt:""}),Object(N.jsx)("button",{onClick:function(){return t.handleCategoryClick(n)},children:n})]},n)})),i=this.state.selectedCategory,r=this.state.userData[i];return Object(N.jsxs)("div",{children:[Object(N.jsx)(M,{content:this.state.outputImage}),Object(N.jsx)(q,{width:"100%",userData:this.state.userData}),Object(N.jsx)("div",{className:"category",children:n}),Object(N.jsx)(H,{handleOutput:this.getSelectedItem,selectedCategory:i,selectedItem:r?r.itemTitle:"",itemSize:e/3}),Object(N.jsx)("button",{className:"download-btn",onClick:function(){return t.downloadOutputImage()},children:"\u4e0b\u8f7d"})]})}}]),a}(o.a.Component),K=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){return Object(n.a)(this,a),e.call(this,t)}return Object(i.a)(a,[{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var t=.7*document.body.clientWidth*.94;return Object(N.jsx)("div",{className:"main",children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)("header",{className:"header"}),Object(N.jsxs)("div",{className:"body",children:[Object(N.jsx)(Q,{width:t>400?376:t<330?310.2:t}),D()?Object(N.jsx)("p",{className:"warning",children:"\u6e29\u99a8\u63d0\u793a\uff1a\u4f60\u5f53\u524d\u5728APP\u5185\u7f6e\u6d4f\u89c8\u5668\u4e2d\uff0c\u82e5\u60f3\u4fdd\u5b58\u56fe\u7247\u8bf7\u70b9\u51fb\u4e0b\u8f7d\u6309\u94ae\u540e\u957f\u6309\u4e0a\u65b9\u9884\u89c8\u533a\u4fdd\u5b58"}):Object(N.jsx)("p",{className:"warning",children:this.props.config.info.interface.footerText})]})]})})}}]),a}(o.a.Component),V=(a(42),a(43),function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).categoryData=void 0,i.state={author:{name:"",email:"",website:""},interface:{footerText:""},title:""},i.categoryData={},i.getFullData=i.getFullData.bind(Object(p.a)(i)),i.getCategoryInfo=i.getCategoryInfo.bind(Object(p.a)(i)),i.onInputChange=i.onInputChange.bind(Object(p.a)(i)),i}return Object(i.a)(a,[{key:"getFullData",value:function(){return{info:{author:Object.assign({},this.state.author),interface:Object.assign({},this.state.interface),title:this.state.title},category:this.categoryData}}},{key:"getCategoryInfo",value:function(t){this.categoryData=t}},{key:"onInputChange",value:function(t,e){switch(e){case"name":case"email":case"website":this.setState({author:Object(f.a)(Object(f.a)({},this.state.author),{},Object(j.a)({},e,t.target.value))});break;case"footerText":this.setState({interface:Object(f.a)(Object(f.a)({},this.state.interface),{},Object(j.a)({},e,t.target.value))});break;case"title":this.setState({title:t.target.value})}}},{key:"onConfirm",value:function(){this.props.picsMetadata&&this.props.handleOutput(this.getFullData())}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("form",{children:[Object(N.jsx)("h2",{children:"\u586b\u5199\u4f5c\u8005\u4fe1\u606f\uff08\u4e5f\u53ef\u4ee5\u4e0d\u586b\uff09"}),"\u540d\u5b57\uff1a",Object(N.jsx)("input",{value:this.state.author.name,type:"text",onChange:function(e){return t.onInputChange(e,"name")}}),Object(N.jsx)("br",{}),"\u90ae\u7bb1\uff1a",Object(N.jsx)("input",{value:this.state.author.email,type:"text",onChange:function(e){return t.onInputChange(e,"email")}}),Object(N.jsx)("br",{}),"\u7f51\u5740\uff1a",Object(N.jsx)("input",{value:this.state.author.website,type:"text",onChange:function(e){return t.onInputChange(e,"website")}}),Object(N.jsx)("br",{}),Object(N.jsx)("h2",{children:"\u586b\u5199\u9875\u9762\u4fe1\u606f\uff08\u4e5f\u53ef\u4ee5\u4e0d\u586b\uff0c\u4f46\u6700\u597d\u586b\uff09"}),"\u9875\u9762\u6807\u9898\uff1a",Object(N.jsx)("input",{value:this.state.title,type:"text",onChange:function(e){return t.onInputChange(e,"title")}}),Object(N.jsx)("br",{}),"\u9875\u811a\u6587\u5b57\uff1a",Object(N.jsx)("input",{value:this.state.interface.footerText,type:"text",onChange:function(e){return t.onInputChange(e,"footerText")}}),Object(N.jsx)("br",{}),Object(N.jsx)("h2",{children:"\u586b\u5199\u5206\u7c7b\u4fe1\u606f"}),this.props.picsMetadata&&Object(N.jsx)(Y,{handleOutput:this.getCategoryInfo,picsMetadata:this.props.picsMetadata}),Object(N.jsx)("input",{className:"form-button",type:"button",value:"\u786e\u5b9a",onClick:function(){return t.onConfirm()}})]})}}]),a}(o.a.Component)),Y=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;Object(n.a)(this,a);var r=E((i=e.call(this,t)).props.picsMetadata);return i.state={categoryRawData:r,data:a.initFormData(r)},i.props.handleOutput(i.state.data),i.handleChange=i.handleChange.bind(Object(p.a)(i)),i}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(t){if(this.props.picsMetadata!==t.picsMetadata){var e=E(this.props.picsMetadata);this.setState({categoryRawData:e,data:a.initFormData(e)})}}},{key:"handleChange",value:function(t,e,a){var n={};switch(Object.assign(n,this.state.data),Object.keys(n).forEach((function(t){n[t]=Object.assign({},n[t])})),a){case"allowBlank":n[e].allowBlank=!n[e].allowBlank;break;case"hide":n[e].hide=!n[e].hide;break;case"index":n[e].index=parseInt(t)}this.setState({data:n}),this.props.handleOutput(JSON.parse(JSON.stringify(n)))}},{key:"render",value:function(){var t=this,e=this.state.categoryRawData,a=Object.keys(e).length,n=Object.keys(e).map((function(n,i){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:Object(N.jsx)("span",{children:e[n].info.title})}),Object(N.jsx)("td",{children:Object(N.jsx)("input",{onChange:function(e){return t.handleChange(e.target.value,n,"allowBlank")},checked:t.state.data[n].allowBlank,name:n+"-allowBlank",type:"checkbox"})}),Object(N.jsx)("td",{children:Object(N.jsx)("input",{onChange:function(e){return t.handleChange(e.target.value,n,"hide")},checked:t.state.data[n].hide,name:n+"-hide",type:"checkbox"})}),Object(N.jsx)("td",{children:Object(N.jsx)("select",{onChange:function(e){return t.handleChange(e.target.value,n,"index")},name:n+"-index",value:t.state.data[n].index,children:Array.from(Array(a)).map((function(t,e){return Object(N.jsxs)("option",{value:e+1,children:[" ",e+1]},e+1)}))})})]},n)}));return Object(N.jsx)("div",{className:"form-category-data",children:Object(N.jsxs)("table",{children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:"\u7c7b\u522b"}),Object(N.jsx)("td",{children:"\u5141\u8bb8\u8be5\u7c7b\u522b\u6709\u7a7a\u767d\u9879"}),Object(N.jsx)("td",{children:"\u8be5\u7c7b\u522b\u4e0d\u5141\u8bb8\u9009\u62e9"}),Object(N.jsx)("td",{children:"\u5c42\u5e8f\uff08\u6570\u5b57\u5927\u7684\u5728\u4e0a\u9762\uff09"})]})}),Object(N.jsx)("tbody",{children:n})]})})}}],[{key:"initFormData",value:function(t){var e={},a=1;for(var n in t)e[n]={title:n,allowBlank:!1,hide:!1,index:a++};return e}}]),a}(o.a.Component),Z=V,$=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;Object(n.a)(this,a),i=e.call(this,t),document.title="\u62c9\u8042\u8033\u5730\u533a",i.state={testFileList:null,formOutput:null,testImageJSX:Object(N.jsx)("div",{})};var r=new Image;return r.src="/sources/linmo/pics/\u8863\u670d/\u84dd\u8272\u536b\u8863.png",r.onload=function(t){t.target&&i.setState({testImageJSX:Object(N.jsx)("div",{style:{backgroundColor:"#fff"},children:Object(N.jsx)(A,{imageObjs:[r],canvasSize:[90,90],border:5})})})},i}return Object(i.a)(a,[{key:"getFileList",value:function(t){this.setState({testFileList:t})}},{key:"getFormOutput",value:function(t){this.setState({formOutput:t})}},{key:"genConfig",value:function(){if(!this.state.testFileList||!this.state.formOutput)return"";console.log(this.state.testFileList,this.state.formOutput);var t=W(this.state.formOutput,this.state.testFileList);return console.log(JSON.stringify(t)),JSON.stringify(t)}},{key:"render",value:function(){var t,e=this,a=this.state.testFileList,n="{}",i="";return a&&(t=z(a),n=JSON.stringify(t),i=function(t){for(var e=[],a=0,n=Array.from(t);a<n.length;a++){var i=n[a].webkitRelativePath.split("/");i[1]===R&&i[3]!==L&&e.push(T(i.slice(1).join("/")))}return U(e)}(a)),Object(N.jsx)("div",{className:"App",children:Object(N.jsxs)("header",{className:"App-header",children:[Object(N.jsx)("p",{children:"FBI WARNING"}),Object(N.jsx)("p",{children:"\u6b22\u8fce\u4f60\u6765\u5230\u795e\u79d8\u9875\u9762"}),this.state.testImageJSX,Object(N.jsx)(P,{handleOutput:function(t){return e.getFileList(t)}}),Object(N.jsx)(Z,{handleOutput:function(t){return e.getFormOutput(t)},picsMetadata:t?t.data:void 0}),i,Object(N.jsx)(F,{fileContent:n,filename:"download_metadata_test.json",className:"",children:"metadata.json\u4e0b\u8f7d\u6d4b\u8bd5"}),Object(N.jsx)(F,{fileContent:this.genConfig(),filename:"download_config_test.json",className:"",children:"config.json\u4e0b\u8f7d\u6d4b\u8bd5"}),Object(N.jsx)(B,{imageFile:a?a[2]:null})]})})}}]),a}(o.a.Component),tt=(a(44),function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),i=e.call(this,t),document.title="\u521b\u5efa\u5c5e\u4e8e\u4f60\u7684\u634f\u8138\u6e38\u620f\uff01",i.state={fileList:null,formOutput:null},i}return Object(i.a)(a,[{key:"getFileList",value:function(t){this.setState({fileList:t})}},{key:"getFormOutput",value:function(t){this.setState({formOutput:t})}},{key:"genConfig",value:function(){if(!this.state.fileList||!this.state.formOutput)return"";var t=W(this.state.formOutput,this.state.fileList);return console.log(JSON.stringify(t)),JSON.stringify(t)}},{key:"render",value:function(){var t,e,a=this,n=this.state.fileList,i='\n    {\n        "root": "/sources/'.concat((t=n)&&0!==t.length?t[0].webkitRelativePath.split("/")[0]:"",'/"\n    }\n    '),r="{}";return n&&(e=z(n),r=JSON.stringify(e)),console.log(n),Object(N.jsx)("div",{className:"App",children:Object(N.jsxs)("header",{className:"app-header",children:[Object(N.jsx)("h2",{children:"!\u9192\u76ee! \u8bf7\u4f7f\u7528\u7535\u8111\u8fdb\u884c\u64cd\u4f5c"}),Object(N.jsx)("h2",{children:"\u9996\u5148"}),Object(N.jsx)("p",{children:"\u6240\u6709\u7684\u7d20\u6750\u5fc5\u987b\u662f\u6b63\u65b9\u5f62\u4e14\u5927\u5c0f\u4e00\u81f4\uff0c\u683c\u5f0f\u4e3apng"}),Object(N.jsx)("h2",{children:"\u7136\u540e"}),Object(N.jsx)("p",{children:"\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u53d6\u4e2a\u82f1\u6587\u540d\uff0c\u6bd4\u5982 example"}),Object(N.jsx)("p",{children:"\u8fdb\u5165\u8fd9\u4e2a\u6587\u4ef6\u5939\uff0c\u518d\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u53d6\u540d\u4e3a pics"}),Object(N.jsx)("p",{children:"\u8fdb\u5165 pics \u6587\u4ef6\u5939\uff0c\u6309\u7167\u4f60\u7684\u60f3\u6cd5\u65b0\u5efa\u82e5\u5e72\u4e2a\u6587\u4ef6\u5939\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4ee3\u8868\u4f60\u7684\u7d20\u6750\u7684\u5206\u7c7b"}),Object(N.jsx)("p",{children:"\u6bd4\u5982 \u8868\u60c5 \u8863\u670d \u80cc\u666f \u7b49\u7b49"}),Object(N.jsx)("p",{children:"\u5728\u76f8\u5e94\u7684\u6587\u4ef6\u5939\u4e2d\u653e\u5165\u76f8\u5e94\u7684\u7d20\u6750"}),Object(N.jsx)("h2",{children:"\u5728\u8fd9\u91cc\u4f20\u5165\u521a\u624d\u7b2c\u4e00\u6b21\u5efa\u597d\u7684\u6587\u4ef6\u5939\uff08\u6bd4\u5982 example\uff09"}),Object(N.jsx)(P,{handleOutput:function(t){return a.getFileList(t)}}),Object(N.jsx)(Z,{handleOutput:function(t){return a.getFormOutput(t)},picsMetadata:e?e.data:void 0}),Object(N.jsx)("h2",{children:"\u586b\u5b8c\u70b9\u51fb\u786e\u5b9a\u540e\u4f1a\u51fa\u73b0\u4e09\u4e2a\u4e0b\u8f7d\u6309\u94ae\uff1a"}),this.state.formOutput?Object(N.jsxs)("div",{children:[Object(N.jsx)(F,{fileContent:r,filename:"metadata.json",className:"download-config-link",children:"\u4e0b\u8f7dmetadata.json"}),Object(N.jsx)(F,{fileContent:this.genConfig(),filename:"config.json",className:"download-config-link",children:"\u4e0b\u8f7dconfig.json"}),Object(N.jsx)(F,{fileContent:i,filename:"root.json",className:"download-config-link",children:"\u4e0b\u8f7droot.json"})]}):Object(N.jsx)("div",{}),Object(N.jsx)("h2",{children:"\u4e0a\u9762\u4e09\u4e2a\u6587\u4ef6\u4e0b\u8f7d\u540e"}),Object(N.jsx)("p",{children:"\u8fdb\u5165\u521a\u624d\u521b\u5efa\u7684 example \u6587\u4ef6\u5939\uff0c\u5c06\u8fd9\u4e09\u4e2a\u6587\u4ef6\u653e\u5230\u6587\u4ef6\u5939\u4e2d"}),Object(N.jsx)("p",{children:"\u8fd9\u6837\u4f60\u7684\u8d44\u6e90\u5305\u5c31\u5b8c\u6210\u5566\uff01\u6492\u82b1\u2728"}),Object(N.jsx)("h2",{children:"\u63a5\u4e0b\u6765\u8fdb\u5165\u6700\u540e\u4e00\u6b65\uff08\u975e\u5e38\u590d\u6742\uff09"}),Object(N.jsx)("p",{children:"\u4e0a\u4f20\u4f60\u7684\u8d44\u6e90\u5305\u5230\u53ef\u4ee5\u88ab\u8bbf\u95ee\u5230\u7684\u5730\u65b9\uff0c\u6709\u4e24\u79cd\u9009\u62e9\uff1a"}),Object(N.jsxs)("p",{children:["1. \u901a\u8fc7\u63d0pr\u7684\u65b9\u5f0f\u4e0a\u4f20\u5230",Object(N.jsx)("a",{href:"https://github.com/mengrru/lm-instance",children:"\u6b64\u4ed3\u5e93"}),"\u7684 main \u5206\u652f\u7684 sources \u76ee\u5f55\u4e0b"]}),Object(N.jsxs)("p",{children:["2. \u81ea\u884c\u8d2d\u4e70\u9759\u6001\u5b58\u50a8\u670d\u52a1\uff08\u5982\u963f\u91cc\u4e91OSS\uff09\u4e0a\u4f20\uff0c\u5e76\u5c06 root.json \u4e2d\u7684 root \u5b57\u6bb5\u6539\u4e3a\u4f60\u7684\u8d44\u6e90\u6240\u5728\u7684\u7edd\u5bf9\u5730\u5740\uff0c\u7136\u540e\u901a\u8fc7\u63d0pr\u7684\u65b9\u5f0f\u4e0a\u4f20 root.json \u5230",Object(N.jsx)("a",{href:"https://github.com/mengrru/lm-instance",children:"\u6b64\u4ed3\u5e93"}),"\u7684 main \u5206\u652f\u7684 sources \u76ee\u5f55\u4e0b"]}),Object(N.jsx)("p",{children:"\u4e0a\u8ff0\u6559\u7a0b\u6211\u6682\u65f6\u61d2\u5f97\u5199\u4e86\uff0c\u5982\u679c\u60f3\u4e0a\u4f20\u53ef\u4ee5\u76f4\u63a5\u53d1\u90ae\u4ef6\u5230 mengrru@outlook.com \u8ba9\u6211\u5e2e\u4f60\u4e0a\u4f20\u767d\u5ad6\u6211\u7684OSS"})]})})}}]),a}(o.a.Component));function et(){document.title="\u6b22\u8fce\u5149\u4e34";var t={display:"inline-block",border:"1px solid rgb(73,125,63)",padding:"5px 5px",borderRadius:"7px",margin:"5px",color:"rgb(73,125,63)",textDecoration:"none",opacity:".7",marginTop:"30px"};return Object(N.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:[Object(N.jsx)("a",{style:t,href:"/linmo",children:"\u6797\u58a8\u6362\u88c5\u6e38\u620f"}),Object(N.jsx)("a",{style:t,href:"/linmo/auto",children:"\u7528\u4f60\u7684id\u751f\u6210\u4e00\u4e2a\u6797\u58a8"}),Object(N.jsx)("a",{style:t,href:"/create",children:"\u6211\u4e5f\u8981\u521b\u5efa\u4e00\u4e2a\u6362\u88c5\u6e38\u620f\uff08\u6d4b\u8bd5\uff09"})]})}a(45);var at=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).state={userOutputData:X(k.root,i.props.config.category,i.props.metadata.data),outputImageBase64:"",userInput:""},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.refreshImage()}},{key:"componentDidUpdate",value:function(){}},{key:"onInputChange",value:function(t){this.setState({userInput:t})}},{key:"onConfirm",value:function(){this.genUserData()}},{key:"genUserData",value:function(){for(var t=this,e=this.props.config.category,a=Object.keys(this.props.config.category).filter((function(t){return!e[t].info.hide})).sort((function(t,e){return t<e?1:-1})),n=a.length,i=J.Md5.hashStr(this.state.userInput),r=i.length,s=Math.floor(r/n),c=parseInt(Array(s).fill("F").join(""),16),o=X(k.root,e,this.props.metadata.data),u=0;u<n;u++){var l=parseInt(i.slice(u*s,u*s+s),16),h=a[u],d=e[h].items.slice().sort((function(t,e){return t.title<e.title?1:-1})),j=d.length,f=Math.floor(l/(c/j));o[h]=_(k.root,e,this.props.metadata.data,h,d[f].pic.picId)}this.setState({userOutputData:o},(function(){t.refreshImage()}))}},{key:"refreshImage",value:function(){var t=this;this.setState({outputImageBase64:""}),w(this.state.userOutputData).then((function(e){e.toBlob((function(e){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){var a;t.setState({outputImageBase64:null===(a=e.target)||void 0===a?void 0:a.result})}}))}))}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{className:"auto-container",children:[Object(N.jsx)("h2",{className:"auto-title",children:this.props.config.info.title}),Object(N.jsx)("div",{className:"auto-image-container",children:this.state.outputImageBase64?Object(N.jsx)("img",{src:this.state.outputImageBase64,alt:this.props.config.info.title}):"\u52aa\u529b\u52a0\u8f7d\u4e2d..."}),Object(N.jsxs)("div",{className:"auto-input-container",children:[Object(N.jsx)("input",{className:"auto-input",type:"text",placeholder:"\u8f93\u5165\u4f60\u7684\u540d\u5b57\u3001id\u6216\u5176\u5b83",onChange:function(e){return t.onInputChange(e.target.value)}}),Object(N.jsx)("br",{}),Object(N.jsx)("button",{className:"auto-button",onClick:function(){return t.onConfirm()},children:"\u70b9\u51fb\u83b7\u5f97\u56fe\u7247"})]}),Object(N.jsx)("div",{className:"auto-link-container",children:Object(N.jsx)("a",{href:"/"+this.props.rootName,children:"\u53bb\u73a9\u6362\u88c5\u6e38\u620f"})})]})}}]),a}(o.a.Component);var nt=function(t){Object(r.a)(a,t);var e=Object(s.a)(a);function a(t){var i;return Object(n.a)(this,a),(i=e.call(this,t)).state={config:null,metadata:null,pageId:null},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this;switch(this.state.pageId){case"create":case"test":return}C("/sources/"+this.state.pageId+"/root.json").then((function(e){var a=JSON.parse(e);k.root=a.root;var n=k.root;C(n+"config.json").then((function(e){t.setState({config:e})})).catch((function(t){throw Error(t)})),C(n+"metadata.json").then((function(e){t.setState({metadata:e})})).catch((function(t){throw Error(t)}))}))}},{key:"render",value:function(){var t=this.state.pageId,e=this.state.isAuto;switch(t){case"create":return Object(N.jsx)(tt,{});case"test":return Object(N.jsx)($,{});default:if(!this.state.config||!this.state.metadata)return Object(N.jsx)("div",{children:"loading"});try{var a=JSON.parse(this.state.config),n=JSON.parse(this.state.metadata);return k.config=a,k.metadata=n,document.title=a.info.title,e?Object(N.jsx)(at,{config:a,metadata:n,rootName:t}):Object(N.jsx)(K,{config:a,metadata:n})}catch(i){return Object(N.jsx)("div",{children:"\u51fa\u9519\u5566QAQ"})}}}}],[{key:"getDerivedStateFromProps",value:function(t,e){return t.match.params.id!==e.pageId?{pageId:t.match.params.id,isAuto:"auto"===t.match.params.auto}:null}}]),a}(o.a.Component),it=Object(d.f)(nt);l.a.render(Object(N.jsx)(o.a.StrictMode,{children:Object(N.jsx)(h.a,{children:Object(N.jsx)("div",{children:Object(N.jsxs)(d.c,{children:[Object(N.jsx)(d.a,{path:"/:id/:auto",children:Object(N.jsx)(it,{})}),Object(N.jsx)(d.a,{path:"/:id",children:Object(N.jsx)(it,{})}),Object(N.jsx)(d.a,{path:"/",children:Object(N.jsx)(et,{})})]})})})}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.34451e3d.chunk.js.map